\section{Anatomy of Standard Strategies}
\label{sec:eval-common-strategies}

In order to construct new baselines and their performance differences,
we evaluated tiebreaking strategies for domain-independent optimal
classical planning.  In our experiments, all planners are based on Fast
Downward, and all experiments are run with a 5-minute,
4GB memory limit for the search binary (FD translation/preprocessing
times are not included in the 5-minute limit).  All experiments were
conducted on Xeon E5410@2.33GHz CPUs. 

% following paragraph is added in order to avoid repeating the list of domains not
% included due to no coverage difference.
We used 1104 instances from 35 standard benchmark domains. These
instances are those originally included in the test suite of Fast
Downward planning system. In detail, they are: airport(50),
barman-opt11(20), blocks(35), cybersec(19), depot(22), driverlog(20),
elevators-opt11(20), floortile-opt11(20), freecell(80), grid(5),
gripper(20), hanoi(30), logistics00(28), miconic(150), mprime(35),
mystery(30), nomystery-opt11(20), openstacks-opt11(20),
parcprinter-opt11(20), parking-opt11(20), pathways(30),
pegsol-opt11(20), pipesworld-notankage(50), pipesworld-tankage(50),
psr-small(50), rovers(40), scanalyzer-opt11(20), sokoban-opt11(20),
storage(30), tidybot-opt11(20), tpp(30), transport-opt11(20),
visitall-opt11(20), woodworking-opt11(20), zenotravel(20).

\subsection{Does Last-Resort Strategies Make a Difference?}

We first compared two commonly used tiebreaking strategies, $[f,h,\fifo]$, $[f,h,\lifo]$, which
first break ties according to $h$, and then apply \fifo or \lifo
last-resort tiebreaking, respectively.
Results for LMcut heuristic \cite{Helmert2009} and M\&S heuristic \cite{HelmertHHN14} are
shown in \reftbl{tbl:lmcut-ipc-std} and \reftbl{tbl:mands-ipc-std}
(leftmost 2 columns), respectively.
Differences in coverage are observed in several domains, and
$[f,h,\lifo]$ outperforms $[f,h,\fifo]$ overall.

\begin{table}[htbp]
 {
 \centering
 \input{tables/4-1-summary.tex}
 \caption{
 Summary results: Coverage comparison (the number of instances solved in 5min, 4GB, LMcut
 heuristics) between
 the standard baseline tiebreaking algorithms. 
 }
 \label{tbl:lmcut-ipc-std}
 }
\end{table}


\begin{table}[htbp]
 {
 \centering
 \input{tables/4-ipc-lmcut.tex}
 \caption{
 Coverage comparison (the number of instances solved in 5min, 4GB, LMcut
 heuristics) between
 the standard baseline tiebreaking algorithms. We highlight the
 best results when the difference between the maximum and the minimum coverage exceeds 2.
 }
 \label{tbl:lmcut-ipc-std}
 }
\end{table}

\begin{table}[htbp]
 {
 \centering
 \input{tables/4-ipc-mands.tex}
 \caption{
 Coverage comparison (the number of instances solved in 5min, 4GB, M\&S heuristics) between
 the standard baseline tiebreaking algorithms. We highlight the
 best results when the difference between the maximum and the minimum coverage exceeds 2.
 }
 \label{tbl:mands-ipc-std}
 }
\end{table}

\subsection{Is $h$-Based Tiebreaking Necessary?}

\label{sec:noh}

In the right half of \reftbl{tbl:lmcut-ipc-std} and
\reftbl{tbl:mands-ipc-std}, we show the results of $[f, \fifo]$ and
$[f, \lifo]$, the \astar variants which rely on \fifo or \lifo
last-resort tiebreaking only.  $[f,\lifo]$, which simply breaks ties
among nodes with the same $f$-cost by expanding the most recently
generated nodes first \cite{korf1985depth}, clearly dominates
$[f,\fifo]$.  Interestingly, the performance of the $[f,\lifo]$ strategy
is comparable to $[f,h,\lifo]$ and $[f,h,\fifo]$.
This may be surprising, considering the ubiquity of $h$-based tiebreaking in the search and planning communities.

\lifo behaves somewhat similarly to $h$-based tiebreaking, in the following sense:
\lifo expands the most recently generated node $n$.
For any child $n'$, 
if the heuristic function is admissible and $f(n') = f(n)$, there are only 2 possibilities :
(1) $g(n') > g(n)$ and $h(n') < h(n)$, or
(2) $g(n') = g(n)$ and $h(n') = h(n)$,
because $g(n)+h(n)=g(n')+h(n')$.
Thus, as \lifo expands nodes in a ``depth-first'' manner,
the nodes that continue to be expanded in the plateau by \lifo have non-increasing $h$-values,
much like in $h$-based tiebreaking which always searches toward the least $h$ cost.
Although the expansion order of $[f,\lifo]$ is not strictly the same as that of $h$-based tiebreaking strategies,
this explains their similarity in performances.

% \textbf{An in-depth investigation of the behavior of $[f,\lifo]$ vs. $h$-based tiebreaking is a direction for future work.}
% Compared to the $h$-based variants which explicitly selects nodes with smaller $h$ and its expanded nodes have non-increasing $h$-values,
% This has the same  can behave somewhat similarly to actively expanding nodes with low $h$-values, as done by $h$-based tiebreaking.
% \citeauthor{burns2012implementing}
% (\citeyear{burns2012implementing}) writes ``the goal can be found more
% quickly in the final $f$ layer of search'' about $h$ tiebreaking.

\subsection{Plateaus and Tiebreaking}

\refig{fig:f-h-eval} gives us a
more fine-grained analysis by comparing the number of node evaluation
(computations of \lmcut) in each instance between $[f,h,\lifo]$ and $[f,h,\fifo]$ strategies.
It shows that the difference in the number of nodes
evaluated can sometimes be larger than a factor of 10 (\pddl{Openstacks}, \pddl{Cybersec} domains).
Contrary to the conventional wisdom, 
these results suggest that last-resort tiebreaking can have a significant effect on
the search performance.

\begin{figure}[htbp]
 \centering \relsize{-3}
 \includegraphics{tables/aaai16-30min-5min-cut/aaai16prelim3/evaluated-lmcut_ff-lmcut_lf.pdf}
 \caption{The number of LMcut evaluations on various planning domains,
 with standard \fifo vs \lifo last-resort tiebreaking, both with $h$
 tiebreaking. \lifo evaluates  less than $1/10$ of the nodes evaluated
 by \fifo in \pddl{Cybersec} and \pddl{Openstacks}. 
 }
 \label{fig:f-h-eval}
\end{figure}

% In a plateau, the heuristics do not provide any useful guidance -- a
% plateau region requires a blind search because all neighboring nodes have the same
% estimates. Because of this, search algorithms rely solely on the tiebreaking criterion.

% We further investigate the cause of this performance difference in detail.

The effect of the last-resort tiebreaking strategies (\lifo or
\fifo) under the presence of $h$-tiebreaking is
limited to the search plateau $\plateau{f,h}$, the set of nodes which
share the same $f$ values and $h$ values.
% 
Also, in optimal search, the two \astar with
different last-resort tiebreaking strategies both search the same set of
nodes in the region where $f<f^*$.
% 
% If $h$-tiebreaking is enabled, the two \astar variants also expands the same number of nodes with $h>0$.
Furthermore, the nodes with $h>0$ never become the goal nodes when $h$ is admissible.
% 
Therefore, the effect of last-resort tiebreaking is limited to
the final plateau $\plateau{f^*,0}$.
 
Conventionally, 
this final plateau, $\plateau{f^*,0}$, was naively considered to be very small compared to the
total size of the search space required to be expanded by \astar.
However, counter-intuitively, such a region can be so large enough to
cause a performance difference, or in fact it can even account for \emph{most} of the
search effort required by \astar.

\refig{fig:plateau} plots the size of this final plateau on 1104 IPC
benchmark instances.  The $y$-axis represents the number of nodes with
$f=f^*, h=0$, the final plateau, and the $x$-axis represents the total
number of nodes expanded so far. This figure suggests that, in some
domains such as \pddl{Openstacks} and \pddl{Cybersec}, the planner
spends most of the runtime searching the final plateau for a solution,
even with the help of $h$ tiebreaking.

One natural question might be about what makes these two domains,
\pddl{Openstacks} and \pddl{Cybersec}, different from all other domains
which have much smaller final plateaus.

\begin{figure}[htbp]
   \centering
  \includegraphics{tables/aaai16-frontier/aaai16prelim3/lmcut_frontier-front.pdf}
  \caption{
 The number of nodes with $f=f^*, h=0$ (y-axis), which form
  the final plateau when $h$-based tiebreaking is enabled, compared to
  the total number of nodes in the search space (x-axis) with $f\leq
  f^*$ on 1104 IPC benchmark problems.  Note that \pddl{Openstacks}
  and \pddl{Cybersec} instances are near the $y=x$ line.
  This statistics is obtained by running a modified Fast Downward with
 \lmcut which continues searching after the solution is found
 until expanding all nodes with cost $f=f^*$.} \label{fig:plateau}
\end{figure}

